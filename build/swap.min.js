(function(a,b){var c=a.jQuery||a.Zepto,d=function(a){"use strict",this.config={defaultProcessor:"inner"};var b=this;return this.conditionals=a.conditionals||{},this.listeners=a.listeners||[],this.domListeners=[],this.lastCache={},this.config=c.extend(this.config,a||{}),c.each(this.whens,function(a,c){c.call(b)}),this.rebuild(),this};d.prototype.rebuild=function(){this.domListeners.length=0,this.addArea("[data-swap]")},d.prototype.cleanUp=function(){for(var a=this.domListeners.length-1;a>=0;a--){var b=this.domListeners[a];e(b.el)||b.el.parentNode||this.domListeners.splice(a,1)}},d.prototype.addArea=function(a){var b=this;c(a).each(function(){var a=this,d=[].filter.call(this.attributes,function(a){return/^data-/.test(a.name)});c.each(d,function(d,f){var g=f.name.toLowerCase().split("-"),h={},i=g.length;if(i!==4&&i!==3)return!0;if(e(b.tests[g[1]])||e(b.conditionals[g[2]]))return!0;if(i===4){if(e(b.processors[g[3]]))return!0;h.processor=g[3]}else h.processor=b.config.defaultProcessor;h.test=g[1],h.conditional=g[2],h.param=function(a){if(typeof a=="string")try{a=a==="true"?!0:a==="false"?!1:a==="null"?null:+a+""===a?+a:/^(?:\{.*\}|\[.*\])$/.test(a)?c.parseJSON(a):a}catch(b){}else a=undefined;return a}(f.value),h.el=a,b.domListeners.push(h)})})},d.prototype.runTest=function(a,b,d){var f=this,g=!0,h=this.tests[b];if(!e(h.restrict)&&h.restrict[d])return!1;try{var i=h.call(this)}catch(j){return!1}return c.each(a,function(a,b){if(!f.filters[a](i,b))return g=!1,!1}),g},d.prototype.check=function(a){var b=this,d={};a=a||"manual",c.each([b.listeners,b.domListeners],function(f,g){c.each(g,function(c,f){var g=f.conditional+"#"+f.test;e(d[g])&&(d[g]=b.runTest(b.conditionals[f.conditional],f.test,a));if(!e(b.lastCache[g])&&b.lastCache[g]===d[g])return!0;d[g]&&(typeof f.processor=="function"?f.processor.call(b,f.param,f.el):b.processors[f.processor](f.param,f.el))})}),b.lastCache=d},d.prototype.whens={resize:function(){var b=this;c(a).on("resize",function(){b.check("resize")})},domready:function(){var a=this;c(b).on("ready",function(){a.check("ready")})}},d.prototype.tests={width:function(){return c(a).width()},height:function(){return c(a).height()},dpr:function(){if(!e(a.devicePixelRatio))return a.devicePixelRatio;throw new Error("not supported")}},d.prototype.tests.dpr.restrict={resize:!0},d.prototype.processors={attr:function(a,b){if(typeof a!="object")return!1;c(b).attr(a)},src:function(a,b){c(b).attr("src",a)},inner:function(a,b){c(b).html(a)},ref:function(a,b){c(b).html(c(a).html())}},d.prototype.conditionals={},d.prototype.listeners=[],d.prototype.filters={eq:function(a,b){return a===b},lt:function(a,b){return a<b},gt:function(a,b){return a>b},not:function(a,b){return a!==b}};var e=function(a){return typeof a=="undefined"};a.Swap=d})(window,document);