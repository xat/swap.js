(function(a,b){var c=a.jQuery||a.Zepto,d=function(a){"use strict",this.config={defaultProcessor:"inner",defaultSelector:"data-swap"};var b=this;return a=a||{},this.conditionals=a.conditionals||{},this.listeners=a.listeners||[],this.domListeners=[],this.lastCache={},this.config=c.extend(this.config,a||{}),c.each(this.whens,function(a,c){c.call(b)}),this};d.prototype.rebuild=function(){this.domListeners.length=0,this.addArea("["+this.config.defaultSelector+"]")},d.prototype.cleanUp=function(){for(var a=this.domListeners.length-1;a>=0;a--){var b=this.domListeners[a];e(b.el)||b.el.parentNode||this.domListeners.splice(a,1)}},d.prototype._extractAttr=function(a){var b=a.name.toLowerCase().split("-"),c={},d=b.length;if(d!==4&&d!==3)return!1;b[2].substring(0,1)==="."&&(c.neg=!0,b[2]=b[2].slice(1));if(e(this.tests[b[1]])||e(this.conditionals[b[2]]))return!1;if(d===4){if(e(this.processors[b[3]]))return!1;c.processor=b[3]}else c.processor=this.config.defaultProcessor;return c.test=b[1],c.conditional=b[2],c.param=this._parseValue(a.value),c},d.prototype._parseValue=function(a){if(typeof a=="string")try{a=a==="true"?!0:a==="false"?!1:a==="null"?null:+a+""===a?+a:/^(?:\{.*\}|\[.*\])$/.test(a)?f(a):a}catch(b){}else a=undefined;return a},d.prototype.addArea=function(a){var b=this;c(a).each(function(){var a=this,d=[].filter.call(this.attributes,function(a){return/^data-/.test(a.name)});c.each(d,function(c,d){var e=b._extractAttr(d);if(!e)return!0;e.el=a,b.domListeners.push(e)})})},d.prototype.runTest=function(a,b,d){var f=this,g=!0,h=this.tests[b];if(!e(h.restrict)&&h.restrict[d])return!1;try{var i=h.call(this)}catch(j){return!1}return c.each(a,function(a,b){if(!f.filters[a](i,b))return g=!1,!1}),g},d.prototype.check=function(a){var b=this,d={};a=a||"manual",c.each([b.listeners,b.domListeners],function(f,g){c.each(g,function(c,f){var g=f.conditional+(f.neg?"#":"##")+f.test;e(d[g])&&(d[g]=b.runTest(b.conditionals[f.conditional],f.test,a),f.neg&&(d[g]=!d[g]));if(!e(b.lastCache[g])&&b.lastCache[g]===d[g])return!0;d[g]&&(typeof f.processor=="function"?f.processor.call(b,f.param,f.el):b.processors[f.processor](f.param,f.el))})}),b.lastCache=d},d.prototype.whens={resize:function(){var b=this;c(a).on("resize",function(){b.check("resize")})},domready:function(){var a=this;c(b).ready(function(){a.rebuild(),a.check("ready")})}},d.prototype.tests={width:function(){return c(a).width()},height:function(){return c(a).height()},dpr:function(){if(!e(a.devicePixelRatio))return a.devicePixelRatio;throw new Error("not supported")}},d.prototype.tests.dpr.restrict={resize:!0},d.prototype.processors={attr:function(a,b){if(typeof a!="object")return!1;c(b).attr(a)},src:function(a,b){c(b).attr("src",a)},inner:function(a,b){c(b).html(a)},ref:function(a,b){c(b).html(c(a).html())},show:function(a,b){if(a&&a.length>0){c(b).find(a).show();return}c(b).show()},hide:function(a,b){if(a&&a.length>0){c(b).find(a).hide();return}c(b).hide()}},d.prototype.conditionals={},d.prototype.listeners=[],d.prototype.filters={eq:function(a,b){return a===b},lt:function(a,b){return a<b},gt:function(a,b){return a>b},not:function(a,b){return a!==b}};var e=function(a){return typeof a=="undefined"},f=function(){return e(JSON)?e(c.parseJSON)?function(a){return a}:c.parseJSON:JSON.parse}();a.Swap=d})(window,document);